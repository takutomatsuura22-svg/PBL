# PBL AI ダッシュボード アプリ説明書

## 📋 目次

1. [アプリ概要](#アプリ概要)
2. [主要機能](#主要機能)
3. [各ページの詳細](#各ページの詳細)
4. [データ管理](#データ管理)
5. [AI機能](#ai機能)
6. [使い方ガイド](#使い方ガイド)

---

## アプリ概要

**PBL AI ダッシュボード**は、PBL（Project-Based Learning）における学生の状態を可視化し、適切な支援を提供するためのAI支援型マネジメントツールです。

### 主な目的

- **学生の状態可視化**: モチベーションとタスク量を2軸マップで可視化
- **早期問題検知**: 危険な状態の学生を自動検出し、早期介入を支援
- **タスク最適化**: AIによるタスク再割り当て提案で負荷バランスを改善
- **プロジェクト管理**: WBS（Work Breakdown Structure）の管理と進捗追跡

### 対象ユーザー

- **教育(PM)**: プロジェクト全体の統括、チーム管理、学生の状態監視、個別支援
- **生徒(PL)**: 自己チェックイン、タスク確認、自分の状態確認

---

## 主要機能

### 1. 📊 マネジメントページ（ダッシュボード）

**URL**: `/dashboard`

**機能**:
- **2軸マップ**: モチベーション（横軸）× タスク量（縦軸）で学生の状態を可視化
- **危険領域の自動検出**: モチベーション低・タスク量高の学生を赤色で表示
- **統計情報**: 全体の学生数、危険領域の学生数、チーム別の分布
- **学生一覧**: ステータス別（危険/注意/良好）の学生リスト
- **個別ページへのリンク**: 各学生の詳細ページへ直接アクセス

**使い方**:
1. ページを開くと、全学生が2軸マップ上にプロットされます
2. 危険領域（左下の赤いエリア）にいる学生は要注意
3. 各点をクリックすると、その学生の詳細ページに移動します

---

### 2. 👥 PMページ（統括ダッシュボード）

**URL**: `/pm`

**機能**:
- **サマリーカード**: 危険メンバー数、介入推奨数、遅延タスク数などの統計
- **危険メンバーランキング（簡易版）**: 危険度スコア上位5名を表示
- **今週の介入推奨（簡易版）**: 優先度の高い介入推奨を5件表示
- **AIタスク再割り当て提案**: 負荷バランスを改善するタスク再割り当て案
- **WBS遅延アラート**: 期限超過または遅延リスクの高いタスク
- **リーダーサポートタイミング**: チームリーダーへの支援が必要なタイミング

**詳細ページ**:
- `/pm/danger-ranking`: 危険メンバーランキング（全員・詳細分析）
- `/pm/interventions`: 介入推奨（全件・具体的なアクション）
- `/pm/task-reassignments`: タスク再割り当て提案（全件）
- `/pm/delayed-tasks`: 遅延タスクアラート（全件）
- `/pm/leader-support`: リーダーサポートタイミング（全件）

---

### 3. 👤 学生個別ページ

**URL**: `/student/[id]`

**機能**:
- **基本情報**: 名前、MBTI、動物タイプ、所属チーム
- **スキル情報**: 企画・実行・調整・探索の各スキルスコア
- **現在の状態**: モチベーションスコア、タスク量スコア、危険度スコア
- **タスク一覧**: 担当タスクの一覧（ステータス、難易度、締切）
- **AI分析**: 学生の特徴分析と推奨アクション
- **タスク再割り当て提案**: その学生に関連する再割り当て案
- **モチベーショントレンド**: 時系列でのモチベーション・エネルギー・ストレスの推移

**関連ページ**:
- `/student/[id]/motivation-trend`: モチベーショントレンドの詳細グラフ

---

### 4. 📋 WBS管理

#### WBS一覧・アップロード

**URL**: `/wbs`

**機能**:
- **WBS一覧表示**: アップロード済みのWBSファイル一覧
- **WBSアップロード**: CSV/JSON形式のWBSファイルをアップロード
- **WBS選択**: 使用するWBSを選択（選択したWBSのタスクがアプリで使用されます）
- **WBS削除**: 不要なWBSファイルを削除

**対応形式**:
- CSV形式（日本語列名対応）
- JSON形式

**CSV形式の列名例**:
- `ステータス` / `Status`
- `カテゴリ` / `Category`
- `タスク1` / `タスク2`（タイトル）
- `担当者` / `Assignee`
- `開始日` / `Start Date`
- `終了日` / `End Date`
- `レビュワー` / `Reviewer`
- `成果物` / `Deliverable`

#### WBSタスク一覧

**URL**: `/wbs/view`

**機能**:
- **タスク一覧表示**: 選択中のWBSの全タスクを表示
- **検索・フィルタ**: タスク名、説明、IDで検索
- **ステータスフィルタ**: 完了/進行中/未着手でフィルタ
- **カテゴリフィルタ**: カテゴリ別でフィルタ
- **担当者フィルタ**: 担当者別でフィルタ
- **ソート**: 開始日、終了日、難易度などでソート
- **AI活用方法**: 各タスクに最適なAI活用方法を自動生成・表示
- **タスク編集**: タスクのステータス、担当者などを編集

**統計情報**:
- 総タスク数
- 完了タスク数
- 進行中タスク数
- 未着手タスク数

---

### 5. 📝 日次チェックイン

**URL**: `/checkin`

**機能**:
- **自己報告**: 学生が毎日、自分の状態を報告
- **報告項目**:
  - モチベーション（1-5）
  - エネルギー（1-5）
  - ストレス（1-5）
  - コメント（任意）
- **履歴表示**: 過去のチェックインデータを表示
- **トレンド可視化**: モチベーション・エネルギー・ストレスの推移をグラフで表示

**使い方**:
1. 学生が毎日、自分の状態を入力
2. データは自動的に保存され、モチベーションスコアの計算に反映
3. 過去のデータは学生個別ページの「モチベーショントレンド」で確認可能

---

### 6. 📊 スコア評価ルーブリック

**URL**: `/rubric`

**機能**:
- **評価基準の明確化**: タスク量・モチベーション・危険度スコアの評価基準を表示
- **1-5スコアの定義**: 各スコアレベルに対応する具体的な状態を説明
- **計算方法**: スコアの計算ロジックを説明
- **推奨アクション**: 各スコアレベルに応じた推奨アクションを提示

**評価項目**:
1. **タスク量スコア（Load Score）**: 1（非常に低い）〜 5（非常に高い）
2. **モチベーションスコア（Motivation Score）**: 1（非常に低い）〜 5（非常に高い）
3. **危険度スコア（Danger Score）**: 1（安全）〜 5（緊急介入が必要）

詳細は `/rubric` ページを参照してください。

---

## データ管理

### データソース

アプリは2つのデータソースに対応しています：

#### 1. ファイルベース（デフォルト）

- **場所**: `backend/data/`
- **ファイル**:
  - `students/`: 学生データ（JSON形式、1人1ファイル）
  - `tasks.json`: タスクデータ
  - `teams.json`: チームデータ
  - `wbs/`: WBSファイル（JSON形式）
  - `wbs_config.json`: 現在選択中のWBS設定

#### 2. Airtable連携（オプション）

- **設定方法**: `frontend/.env.local` に以下を設定
  ```env
  AIRTABLE_API_KEY=your_api_key
  AIRTABLE_BASE_ID=your_base_id
  ```
- **自動切り替え**: 環境変数が設定されている場合、自動的にAirtableからデータを取得
- **フォールバック**: Airtable接続失敗時は自動的にファイルから読み込み

### データインポート

#### 学生データのインポート

- **方法1**: Airtableの「Students」テーブルに直接入力
- **方法2**: `/import-sample` ページからサンプルデータを投入
- **方法3**: APIエンドポイント `/api/airtable/import-single-student` を使用

#### WBSデータのインポート

1. `/wbs` ページにアクセス
2. 「新しいWBSをアップロード」セクションでCSV/JSONファイルを選択
3. WBS名と説明を入力
4. アップロードボタンをクリック
5. アップロード後、「選択」ボタンでWBSを有効化

---

## AI機能

### 1. モチベーション推定

**機能**: 学生のモチベーションを自動計算

**計算要素**:
- タスクの完了率
- タスクの難易度と負荷
- 日次チェックインデータ（自己報告）
- 活動ログ（コミット、メッセージなど）
- 時間経過による変化

**出力**: 1-5のスコア

### 2. タスク量計算

**機能**: 学生のタスク負荷を自動計算

**計算要素**:
- タスクの難易度（1-5）
- タスクの推定時間
- タスクの緊急度（締切までの日数）
- タスク数

**出力**: 1-5のスコア

### 3. 危険度スコア計算

**機能**: 学生の危険度を総合的に評価

**計算要素**:
- モチベーションスコア
- タスク量スコア
- タスクの遅延状況
- チーム内の位置

**出力**: 1-5のスコア（高いほど危険）

### 4. タスク再割り当て提案（許可/拒否機能付き）

**機能**: 負荷バランスを改善するタスク再割り当てを提案し、許可/拒否で判断可能

**考慮要素**:
- 現在のタスク負荷
- スキル適性
- モチベーション
- タスクの難易度と緊急度
- チーム内の協力関係

**出力**: 再割り当て案のリスト（優先度順）

**許可時の自動更新**:
- ✅ AirtableのTasksテーブルの担当者を更新
- ✅ WBSファイルの担当者を更新
- ✅ 学生の負荷スコアを再計算

詳細は `docs/ai_task_reassignment.md` を参照してください。

### 5. 介入推奨

**機能**: 支援が必要な学生を特定し、具体的なアクションを提案

**考慮要素**:
- 危険度スコア
- モチベーションの低下傾向
- タスクの遅延
- チーム内の関係性

**出力**: 介入推奨のリスト（優先度順、具体的なアクション付き）

### 6. AI活用方法生成

**機能**: 各タスクに最適なAI活用方法を自動生成

**出力**: 
- 推奨AIツール（GitHub Copilot、Cursor AI、ChatGPTなど）
- 具体的なプロンプト例
- 活用のベストプラクティス

---

## 使い方ガイド

### 初回セットアップ

1. **データの準備**
   - 学生データをAirtableまたはファイルに準備
   - WBSファイル（CSV/JSON）を準備

2. **WBSのアップロード**
   - `/wbs` ページでWBSファイルをアップロード
   - アップロード後、「選択」ボタンでWBSを有効化

3. **データの確認**
   - `/dashboard` で学生の状態を確認
   - `/wbs/view` でタスク一覧を確認

### 日常的な使い方

#### 教育(PM)

1. **毎朝**: `/pm` ページで全体状況を確認
   - 危険メンバーランキングをチェック
   - 介入推奨を確認
   - 遅延タスクを確認

2. **定期的に**: `/dashboard` で学生の状態を確認
   - 2軸マップで危険領域の学生を特定
   - 個別ページで詳細を確認

3. **必要に応じて**:
   - `/pm/task-reassignments` でタスク再割り当てを検討
   - `/pm/interventions` で具体的な介入アクションを確認
   - `/pm/leader-support` でリーダーサポートのタイミングを確認
   - 学生個別ページでモチベーショントレンドを確認
   - AI分析と推奨アクションを確認

#### 生徒(PL)

1. **毎日**: `/checkin` で自己チェックイン
   - モチベーション、エネルギー、ストレスを報告

2. **必要に応じて**:
   - `/student/[id]` で自分の状態を確認
   - `/wbs/view` で自分のタスクを確認

### トラブルシューティング

#### タスクが表示されない

1. WBSが選択されているか確認（`/wbs` ページ）
2. `tasks.json` ファイルが正しく更新されているか確認
3. ブラウザをリロード（F5）

#### 学生データが表示されない

1. Airtableの環境変数が正しく設定されているか確認
2. ファイルベースの場合、`backend/data/students/` にJSONファイルがあるか確認
3. ブラウザの開発者ツール（F12）でエラーを確認

#### スコアが更新されない

1. タスクデータが最新か確認
2. 日次チェックインデータが入力されているか確認
3. サーバーを再起動

---

## 技術情報

### 使用技術

- **フロントエンド**: Next.js 14 (App Router), React, TypeScript, Tailwind CSS
- **バックエンド**: Next.js API Routes
- **データベース**: Airtable（オプション）またはJSONファイル
- **可視化**: Recharts

### プロジェクト構造

```
pbl-ai-dashboard/
├── frontend/
│   ├── app/              # ページとAPIルート
│   ├── components/       # UIコンポーネント
│   ├── lib/              # 共通関数
│   └── .env.local        # 環境変数（Airtable設定）
├── backend/
│   ├── ai/               # AI計算モジュール
│   └── data/             # データファイル
└── docs/                 # ドキュメント
```

---

## サポート

### よくある質問

**Q: スコアはどのように計算されますか？**  
A: `/rubric` ページで評価基準を確認できます。詳細な計算ロジックは `docs/rubric.md` を参照してください。

**Q: Airtableとファイルベースのどちらを使うべきですか？**  
A: チームで共有する場合はAirtable、個人利用の場合はファイルベースがおすすめです。

**Q: WBSファイルの形式は？**  
A: CSVまたはJSON形式に対応しています。CSVの場合は日本語列名にも対応しています。

### 関連ドキュメント

- `docs/rubric.md`: スコア評価ルーブリックの詳細
- `docs/motivation_tracking_strategy.md`: モチベーション追跡戦略
- `docs/ai_logic.md`: AI計算ロジックの詳細

---

**最終更新**: 2025-11-17

