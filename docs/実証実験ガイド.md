# PBL AI Dashboard 実証実験ガイド

**バージョン**: 1.0.0  
**最終更新**: 2024年12月  
**対象**: 教育者（PM）、学生（PL）

---

## 📋 目次

1. [実証実験の概要](#実証実験の概要)
2. [システム要件](#システム要件)
3. [セットアップ手順](#セットアップ手順)
4. [主要機能の使い方](#主要機能の使い方)
5. [データ管理](#データ管理)
6. [AI機能の詳細](#ai機能の詳細)
7. [トラブルシューティング](#トラブルシューティング)
8. [実証実験チェックリスト](#実証実験チェックリスト)

---

## 実証実験の概要

### 目的

PBL AI Dashboardは、Project-Based Learningにおける学生の状態を可視化し、適切な支援を提供するためのAI支援型マネジメントツールです。

**実証実験で検証する項目:**
- 学生のモチベーション・負荷の可視化の有効性
- AIによる早期問題検知の精度
- タスク再割り当て提案の実用性
- ChatGPT統合によるアドバイス生成の有用性

### 対象ユーザー

- **教育者（PM）**: プロジェクト全体の統括、チーム管理、学生の状態監視、個別支援
- **学生（PL）**: 自己チェックイン、タスク確認、自分の状態確認

---

## システム要件

### 必須要件

- **Node.js**: v18.0.0以上
- **npm**: v9.0.0以上
- **ブラウザ**: Chrome、Firefox、Edge（最新版）
- **インターネット接続**: Airtable API、OpenAI API（オプション）にアクセス

### オプション要件

- **Airtableアカウント**: データ管理用（推奨）
- **OpenAI APIキー**: ChatGPT統合機能用（オプション）

---

## セットアップ手順

### ステップ1: リポジトリのクローン

```bash
git clone <repository-url>
cd pbl-ai-dashboard
```

### ステップ2: 依存関係のインストール

```bash
npm install
cd frontend
npm install
cd ..
```

### ステップ3: 環境変数の設定

`frontend/.env.local` ファイルを作成:

```env
# Airtable設定（必須）
AIRTABLE_API_KEY=patXXXXXXXXXXXXXX
AIRTABLE_BASE_ID=appXXXXXXXXXXXXXX

# OpenAI設定（オプション - ChatGPT統合機能用）
# OPENAI_API_KEY=sk-proj-XXXXXXXXXXXXXX
```

**Airtable APIキーの取得:**
1. [Airtable](https://airtable.com/) にアクセス
2. アカウントアイコン → Developer hub
3. Personal access tokens → Create new token
4. スコープ: `data.records:read`, `data.records:write`, `schema.bases:write`
5. トークンをコピー

**Airtable Base IDの取得:**
1. AirtableでBaseを開く
2. URLから `appXXXXXXXXXXXXXX` の部分をコピー

**OpenAI APIキーの取得（オプション）:**
1. [OpenAI Platform](https://platform.openai.com/api-keys) にアクセス
2. Create new secret key
3. キーをコピー（二度と表示されません）
4. **重要**: 使用制限を設定（Settings → Billing → Usage limits）

### ステップ4: Airtableのセットアップ

```bash
npm run setup-airtable-auto
```

または手動で:
1. Airtableで以下のテーブルを作成:
   - **Students**: 学生データ
   - **Tasks**: タスクデータ
   - **Teams**: チームデータ
2. 必要なフィールドを追加（詳細は `docs/airtable_setup.md` を参照）

### ステップ5: 開発サーバーの起動

```bash
npm run dev
```

ブラウザで [http://localhost:3000](http://localhost:3000) にアクセス

---

## 主要機能の使い方

### 1. 📊 ダッシュボード（`/dashboard`）

**機能:**
- 全学生を2軸マップ（モチベーション × タスク量）で可視化
- 危険領域の自動検出（赤色表示）
- 統計情報の表示

**使い方:**
1. ページを開くと全学生がマップ上にプロットされます
2. 危険領域（左下）の学生は要注意
3. 各点をクリックで学生詳細ページへ

### 2. 👥 PMページ（`/pm`）

**機能:**
- 危険メンバーランキング
- 介入推奨
- タスク再割り当て提案
- 遅延タスクアラート

**詳細ページ:**
- `/pm/danger-ranking`: 危険メンバー詳細
- `/pm/interventions`: 介入推奨一覧
- `/pm/task-reassignments`: タスク再割り当て提案
- `/pm/delayed-tasks`: 遅延タスク一覧

### 3. 👤 学生個別ページ（`/student/[id]`）

**機能:**
- 基本情報（名前、MBTI、スキル）
- 現在の状態（モチベーション、負荷、危険度）
- タスク一覧
- **AIアドバイス**（ChatGPT統合）
- モチベーショントレンド

**AIアドバイスの取得:**
- ページに「AIアドバイスを生成」ボタンがある場合、クリック
- または API: `GET /api/students/{id}/ai-advice`

### 4. 📋 WBS管理（`/wbs`）

**機能:**
- WBSファイルのアップロード（CSV/JSON）
- WBSの選択・削除
- タスク一覧表示（`/wbs/view`）

**WBSアップロード手順:**
1. `/wbs` ページにアクセス
2. 「新しいWBSをアップロード」でファイルを選択
3. WBS名と説明を入力
4. アップロード後、「選択」ボタンで有効化

### 5. 📝 日次チェックイン（`/checkin`）

**機能:**
- 学生が毎日、自分の状態を報告
- モチベーション・エネルギー・ストレスの入力
- 履歴とトレンドの表示

**使い方:**
1. 学生が毎日 `/checkin` にアクセス
2. スコア（1-5）を入力
3. コメント（任意）を入力
4. 送信

### 6. 🤝 ミーティング管理（`/meetings`）

**機能:**
- ミーティングの記録
- 議事録の管理
- アクションアイテムの追跡

---

## データ管理

### Airtableからのデータ取得

アプリは自動的にAirtableからデータを取得します。

**データソース:**
- **Studentsテーブル**: 学生データ
- **Tasksテーブル**: タスクデータ
- **Teamsテーブル**: チームデータ

**データの更新:**
- Airtableで直接編集
- アプリは自動的に最新データを取得（再読み込み時）

### データのインポート

**学生データ:**
- AirtableのStudentsテーブルに直接入力
- または `/import-sample` ページからサンプルデータを投入

**WBSデータ:**
- `/wbs` ページからCSV/JSONファイルをアップロード

---

## AI機能の詳細

### ルールベースAI（常時稼働）

1. **モチベーション推定**
   - タスク完了率、強みマッチ度、チーム相性から計算
   - 出力: 1-5スコア

2. **稼働負荷計算**
   - タスクの難易度・時間・締切から計算
   - 出力: 1-5スコア

3. **スキル適性推定**
   - MBTIと活動実績から4カテゴリ（企画・実行・調整・探索）を評価
   - 出力: 各カテゴリ1-5スコア

4. **タスク再割り当て提案**
   - 負荷・モチベーション・スキルから最適な担当者を提案

5. **危険度スコア計算**
   - 複数のリスク要因から総合評価
   - 出力: 1-5スコア（高いほど危険）

### ChatGPT統合（オプション）

**前提条件:**
- OpenAI APIキーが設定されていること

**機能:**

1. **学生への個別AIアドバイス**
   - API: `GET /api/students/{id}/ai-advice`
   - モチベーション3.0、ビジネスフレームワーク、1on1スキルを活用
   - 推奨フレームワークを自動提案

2. **タスクの詳細分析**
   - API: `GET /api/tasks/{id}/ai-analysis`
   - 最適なAIツールとフレームワークを提案

3. **チーム分析レポート**
   - API: `GET /api/teams/{id}/ai-analysis`
   - チーム全体の状況分析と改善提案

**統合された知識ベース:**
- モチベーション3.0（ダニエル・ピンク）
- ビジネスフレームワーク図鑑（70種類）
- 1on1の基本と実践
- 学び3.0

**コスト管理:**
- GPT-4o-mini使用（1,000回で約$1）
- 使用制限の設定を推奨（月次$10程度）
- 詳細は `docs/openai_cost_management.md` を参照

---

## トラブルシューティング

### よくある問題

#### 1. データが表示されない

**原因:**
- Airtableの接続エラー
- 環境変数が設定されていない

**解決方法:**
1. `.env.local` ファイルを確認
2. Airtable APIキーとBase IDが正しいか確認
3. ブラウザのコンソールでエラーを確認
4. サーバーログを確認

#### 2. ChatGPT APIが動作しない

**原因:**
- APIキーが設定されていない
- 使用制限に達した

**解決方法:**
1. `.env.local` に `OPENAI_API_KEY` が設定されているか確認
2. OpenAIダッシュボードで使用量を確認
3. フォールバック機能が動作するため、アプリは継続して動作

#### 3. 開発サーバーが起動しない

**原因:**
- ポート3000が使用中
- 依存関係のインストールエラー

**解決方法:**
1. 他のアプリがポート3000を使用していないか確認
2. `npm install` を再実行
3. `node_modules` を削除して再インストール

#### 4. WBSがアップロードできない

**原因:**
- ファイル形式が不正
- 必須フィールドが不足

**解決方法:**
1. CSV/JSON形式を確認
2. 必須列（ステータス、カテゴリ、タスク名など）が含まれているか確認
3. エラーメッセージを確認

---

## 実証実験チェックリスト

### 事前準備

- [ ] システム要件を満たしている
- [ ] 依存関係をインストール済み
- [ ] 環境変数を設定済み
- [ ] Airtableのセットアップ完了
- [ ] 開発サーバーが正常に起動する
- [ ] サンプルデータが投入されている

### データ準備

- [ ] 学生データがAirtableに登録されている
- [ ] チームデータが登録されている
- [ ] WBSデータがアップロードされている
- [ ] タスクデータが登録されている

### 機能確認

- [ ] ダッシュボードが正常に表示される
- [ ] PMページが正常に表示される
- [ ] 学生個別ページが正常に表示される
- [ ] WBS管理が正常に動作する
- [ ] チェックイン機能が正常に動作する
- [ ] AI機能（ルールベース）が正常に動作する

### ChatGPT統合（オプション）

- [ ] OpenAI APIキーが設定されている
- [ ] 学生アドバイス生成が動作する
- [ ] タスク分析が動作する
- [ ] チーム分析が動作する
- [ ] 使用制限が設定されている

### 実証実験中

- [ ] 学生がチェックインを実施している
- [ ] データが正しく更新されている
- [ ] AI提案が適切に生成されている
- [ ] 問題が発生した場合の対応方法を確認

### 実証実験後

- [ ] データをエクスポート（必要に応じて）
- [ ] フィードバックを収集
- [ ] 改善点を記録

---

## サポート

### ドキュメント

- **アプリ説明書**: `docs/アプリ説明書.md`
- **API仕様**: `docs/api_spec.md`
- **データ仕様**: `docs/data_spec.md`
- **ChatGPT統合**: `docs/chatgpt_integration.md`
- **知識ベース統合**: `docs/knowledge_base_integration.md`
- **コスト管理**: `docs/openai_cost_management.md`

### ログの確認

**開発サーバーのログ:**
- ターミナルに表示されるエラーメッセージを確認

**ブラウザのコンソール:**
- F12キーで開発者ツールを開く
- Consoleタブでエラーを確認

**Airtableの接続確認:**
```bash
node scripts/check-sample-data.js
```

---

## 更新履歴

- **v1.0.0** (2024年12月): 実証実験版リリース
  - 基本機能の実装
  - Airtable統合
  - ChatGPT統合（オプション）
  - 知識ベース統合

---

**🎉 実証実験の成功を祈っています！**

